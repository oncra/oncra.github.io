<!DOCTYPE html>
<html lang="en" class="sr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  
  <title>ONCRA - Above Ground Carbon Data Tool</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="container">
    <div id="header">
      <a href="https://oncra.org/" target="_blank">
        <img src="assets/cropped-oncra-logo.png" alt="oncra logo">
      </a>
    </div>

    <h1>Above Ground Carbon <br>Data Tool</h1>

    <div id="kmlRequirementText">
      Create a <strong>.kml file</strong> containing <strong>just 1 polygon</strong>. 
      <a id="exampleKMLFileButton" href="assets/example_kml_file.kml" download="example_kml_file.kml">example .kml file</a>
    </div>

    <div id="dropZoneInstructionText">
      Then upload the <strong>.kml file</strong> below, to get the above ground carbon data within the polygon region.
    </div>

    <div
      id="dropZone"
      ondrop="dropHandler(event)"
      ondragover="dragOverHandler(event)"
      ondragleave="dragLeaveHandler(event)">
      <div id="dropZoneTextContainer">
        <div id="dropZoneText_main">
          <strong>
            Drop .kml file here
          </strong> 
        </div>
        <div id="dropZoneText_or">
          or
        </div>
        <div id="kmlBrowseFileButton" onclick="document.getElementById('kmlInput').click()">Browse file</div>
        <input id="kmlInput" type="file" accept=".kml" style="display: none" onchange="onKMLChange(event)"/>
      </div>
    </div>
    <div id="dropZoneError"></div>
    
    <div id="kmlFileName"></div>
    <canvas id="kmlCanvas" width="600" height="100"></canvas>
    
    <div id="apiButton" class="button"  style="display: none;" onclick="callCedaEndpoints()">Call CEDA Endpoint</div>

    <p id="partialGridWarning" style="display: none">⚠️ The values in the table below only take into account fully covered data grids (shown as green in the "Inside Outside Polygon Map" down below), 
      it doesn't take into account partially covered data grids (shown as orange) yet.
    </p>
    <div id="dataTableBorderWrapper">
      <table id="dataTable">
        <tr>
          <th>Year</th>
          <th>Above Ground Biomass <br>(Mg/ha)</th>
          <th>Carbon <br>(Mg/ha)</th>
          <th>CO2 Equivalent <br>(Mg/ha)</th>
        </tr>
        <tr>
          <td id="dataTable_2010" class="dataTable_yearCell" data-value="2010">2010</td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td id="dataTable_2017" class="dataTable_yearCell" data-value="2017">2017</td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td id="dataTable_2018" class="dataTable_yearCell" data-value="2018">2018</td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td id="dataTable_2019" class="dataTable_yearCell" data-value="2019">2019</td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td id="dataTable_2020" class="dataTable_yearCell" data-value="2020">2020</td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      </table>
    </div>

    <div id="agbCanvasContainer" style="display: none;">
      <h2>AGB Map of Year 2020</h2>
      <canvas id="agbCanvas" width="600" height="900"></canvas>
    </div>

    <div id="innerOuterMapCanvasContainer" style="display: none;">
      <h2>Inside Outside Polygon Map</h2>
      <canvas id="innerOuterMapCanvas" width="600" height="800"></canvas>
    </div>
  </div>
</body>
<script src="scripts/rayCastingService.js"></script>
<script src="scripts/mathService.js"></script>
<script src="scripts/dragService.js"></script>
<script src="scripts/canvasService.js"></script>
<script src="scripts/kmlReader.js"></script>
<script src="scripts/coordinates.js"></script>
<script src="scripts/cedaDataParser.js"></script>
<script src="scripts/cedaClient.js"></script>
<script src="main.js"></script>
</html>